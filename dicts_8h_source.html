<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DMRITool: ThirdParty/Spams/include/dicts.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DMRITool
   &#160;<span id="projectnumber">v0.1.1-139-g860d86b4</span>
   </div>
   <div id="projectbrief">Diffusion MRI Tool</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f4997b634b55596d86e94d04923b6cbf.html">ThirdParty</a></li><li class="navelem"><a class="el" href="dir_b2cde91f6cbafc50139382e04429b425.html">Spams</a></li><li class="navelem"><a class="el" href="dir_13db56d8752dc43d17a8f8bbc49fdbc2.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">dicts.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dicts_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* Software SPAMS v2.1 - Copyright 2009-2011 Julien Mairal </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This file is part of SPAMS.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * SPAMS is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * (at your option) any later version.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * SPAMS is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * along with SPAMS.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifndef DICTS_H</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#define DICTS_H</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="decomp_8h.html">decomp.h</a>&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacespams.html">spams</a></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespacespams.html#a6b215b3081f6a7adc2ea70ffd53617d2">   40</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacespams.html#a6b215b3081f6a7adc2ea70ffd53617d2">buffer_string</a>[50];</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">   41</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22d">constraint_type_D</a> { <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>,  <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da342d29879de6e86977d74fe023a04dbf">L1L2</a>, <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22dad6b32f15ab6f3a04e312a1a07df12864">L1L2FL</a>, <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da0551a3470e9c5b498dfa269c82e8b2a8">L1L2MU</a>};</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a24e929906ec47db394a0236b303c4d31">   42</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309">mode_compute</a> { <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a7e1c9255473878601d75beb52bf2ee0f">AUTO</a>, <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a158572eef9ce280536fbc2e295eeac0a">PARAM1</a>, <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309acdbda3a527ec2818f5c5fcfd21ab3bdb">PARAM2</a>, <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a24e929906ec47db394a0236b303c4d31">PARAM3</a>};</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html">   44</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">struct </span><a class="code" href="structspams_1_1ParamDictLearn.html">ParamDictLearn</a> {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a50eff8c9bc2faa0946126e35dedb7e57">   46</a></span>&#160;      <a class="code" href="structspams_1_1ParamDictLearn.html#a50eff8c9bc2faa0946126e35dedb7e57">ParamDictLearn</a>() : </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a>(<a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3">PENALTY</a>),</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a>(false),</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a>(<a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>),</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>(false),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a>(<a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a7e1c9255473878601d75beb52bf2ee0f">AUTO</a>),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a85408522813cb8c29e03342dc29fa907">t0</a>(1e-5),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">rho</a>(5),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>(0),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a44ff379f95b63c10a7f2d99cc22ff271">mu</a>(0),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a0c2023876ddd664f7a86c8e0c0d90d80">lambda3</a>(0),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aa8f835f2cd4c0fdb14dcd4a7321847b1">lambda4</a>(0),</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">lambda2</a>(0),</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>(0),</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a9a3142320341a669ee76089828ae1eef">approx</a>(0.0),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a2c72d6c74985cca5fdec1838e73d4df2">p</a>(1.0),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">whiten</a>(false),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a473e82c074925d3cf517a0d62ce03b43">expand</a>(false),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a1660ce97b3ef358fba5c1ab19ebe0fba">isConstant</a>(false),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#ac9d6af5817e8f5f56ab7f70a0f094832">updateConstant</a>(true),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a5d9bff6098caee8ab8a0debc6fe862c3">ThetaDiag</a>(false),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a75086bc93d825bc9f11da03c3c9f019a">ThetaDiagPlus</a>(false),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a02981bc66aee73e231564e799f85dc4b">ThetaId</a>(false),</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a5afb727394131f82e3290ce99b5fa271">DequalsW</a>(false),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a29404de369c3cb0e95dff1d4768a02a5">weightClasses</a>(false),</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aac4cca3056a34999a22f29d729cc67eb">balanceClasses</a>(false),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aa846d8d9e6e6a4945ee0a3d6b17f57ed">extend</a>(false),</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a>(false),</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aad7025532886772f710023fb22cd5476">stochastic</a>(false),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#ab958b0fde7ab004a414b3420bb4d7de9">scaleW</a>(false),</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">batch</a>(false),</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>(true),</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>(true),</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#af11f236e8c493294894766235e7a25c8">log</a>(false),</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a25c1e82f1ffa69efd8fed205754ff521">updateD</a>(true),</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a91458c317453dced94ddfbb26338c538">updateW</a>(true),</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#aa127ffd44b0ea184eee15751f477cbf1">updateTheta</a>(true),</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">logName</a>(NULL), </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         <a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a>(1) { };</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a6b4787f6567b015acb3780227147c76b">   85</a></span>&#160;      <a class="code" href="structspams_1_1ParamDictLearn.html#a6b4787f6567b015acb3780227147c76b">~ParamDictLearn</a>() { <span class="keyword">delete</span>[](<a class="code" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">logName</a>); };</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">iter</a>;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">   87</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">   88</a></span>&#160;      <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178">constraint_type</a> <a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a>;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">   89</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a>; </div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">   90</a></span>&#160;      <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22d">constraint_type_D</a> <a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a>;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">   91</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">   92</a></span>&#160;      <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309">mode_compute</a> <a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a>;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a85408522813cb8c29e03342dc29fa907">   93</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a85408522813cb8c29e03342dc29fa907">t0</a>;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">   94</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">rho</a>;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">   95</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a44ff379f95b63c10a7f2d99cc22ff271">   96</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a44ff379f95b63c10a7f2d99cc22ff271">mu</a>;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a0c2023876ddd664f7a86c8e0c0d90d80">   97</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a0c2023876ddd664f7a86c8e0c0d90d80">lambda3</a>;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aa8f835f2cd4c0fdb14dcd4a7321847b1">   98</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#aa8f835f2cd4c0fdb14dcd4a7321847b1">lambda4</a>;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">   99</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">lambda2</a>;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">  100</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a9a3142320341a669ee76089828ae1eef">  101</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a9a3142320341a669ee76089828ae1eef">approx</a>;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a2c72d6c74985cca5fdec1838e73d4df2">  102</a></span>&#160;      T <a class="code" href="structspams_1_1ParamDictLearn.html#a2c72d6c74985cca5fdec1838e73d4df2">p</a>;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">  103</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">whiten</a>;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a473e82c074925d3cf517a0d62ce03b43">  104</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a473e82c074925d3cf517a0d62ce03b43">expand</a>;</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a1660ce97b3ef358fba5c1ab19ebe0fba">  105</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a1660ce97b3ef358fba5c1ab19ebe0fba">isConstant</a>;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#ac9d6af5817e8f5f56ab7f70a0f094832">  106</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#ac9d6af5817e8f5f56ab7f70a0f094832">updateConstant</a>;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a5d9bff6098caee8ab8a0debc6fe862c3">  107</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a5d9bff6098caee8ab8a0debc6fe862c3">ThetaDiag</a>;</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a75086bc93d825bc9f11da03c3c9f019a">  108</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a75086bc93d825bc9f11da03c3c9f019a">ThetaDiagPlus</a>;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a02981bc66aee73e231564e799f85dc4b">  109</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a02981bc66aee73e231564e799f85dc4b">ThetaId</a>;</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a5afb727394131f82e3290ce99b5fa271">  110</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a5afb727394131f82e3290ce99b5fa271">DequalsW</a>;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a29404de369c3cb0e95dff1d4768a02a5">  111</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a29404de369c3cb0e95dff1d4768a02a5">weightClasses</a>;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aac4cca3056a34999a22f29d729cc67eb">  112</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#aac4cca3056a34999a22f29d729cc67eb">balanceClasses</a>;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aa846d8d9e6e6a4945ee0a3d6b17f57ed">  113</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#aa846d8d9e6e6a4945ee0a3d6b17f57ed">extend</a>;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">  114</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a>;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aad7025532886772f710023fb22cd5476">  115</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#aad7025532886772f710023fb22cd5476">stochastic</a>;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#ab958b0fde7ab004a414b3420bb4d7de9">  116</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#ab958b0fde7ab004a414b3420bb4d7de9">scaleW</a>;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">  117</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">batch</a>;</div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">  118</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>;</div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">  119</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#af11f236e8c493294894766235e7a25c8">  120</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#af11f236e8c493294894766235e7a25c8">log</a>;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a25c1e82f1ffa69efd8fed205754ff521">  121</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a25c1e82f1ffa69efd8fed205754ff521">updateD</a>;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a91458c317453dced94ddfbb26338c538">  122</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a91458c317453dced94ddfbb26338c538">updateW</a>;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#aa127ffd44b0ea184eee15751f477cbf1">  123</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#aa127ffd44b0ea184eee15751f477cbf1">updateTheta</a>;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">  124</a></span>&#160;      <span class="keywordtype">char</span>* <a class="code" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">logName</a>;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">  125</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;};</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html">  128</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classspams_1_1Trainer.html">Trainer</a> {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="classspams_1_1Trainer.html">Trainer</a>();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <a class="code" href="classspams_1_1Trainer.html">Trainer</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> k, <span class="keyword">const</span> <span class="keywordtype">int</span> batchsize = 256,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_THREADS=-1);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="classspams_1_1Trainer.html">Trainer</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; D, <span class="keyword">const</span> <span class="keywordtype">int</span> batchsize = 256,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_THREADS=-1);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="classspams_1_1Trainer.html">Trainer</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; A, <span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; B, <span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; D,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> itercount, <span class="keyword">const</span> <span class="keywordtype">int</span> batchsize, </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_THREADS);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">void</span> train(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, <span class="keyword">const</span> <a class="code" href="structspams_1_1ParamDictLearn.html">ParamDictLearn&lt;T&gt;</a>&amp; param);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">void</span> trainOffline(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, <span class="keyword">const</span> <a class="code" href="structspams_1_1ParamDictLearn.html">ParamDictLearn&lt;T&gt;</a>&amp; param);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">void</span> train(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, <span class="keyword">const</span> <a class="code" href="namespacespams.html#ac524233de7de47bc45f57cde5a2470d1">vector_groups</a>&amp; groups,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> J, <span class="keyword">const</span> <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178">constraint_type</a></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">whiten</a> = <span class="keyword">false</span>, <span class="keyword">const</span> T* param_C = NULL,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a2c72d6c74985cca5fdec1838e73d4df2">p</a> = 1, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a> = <span class="keyword">false</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#aa568739ae8add04c588330e061e69a80">  154</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#aa568739ae8add04c588330e061e69a80">getA</a>(<a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; A)<span class="keyword"> const </span>{ A.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(_A);};</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#ad4d630bfd214f2f615a3ea5314b9b99e">  155</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#ad4d630bfd214f2f615a3ea5314b9b99e">getB</a>(<a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; B)<span class="keyword"> const </span>{ B.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(_B);};</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#ae9b5c1be61a24d5fcfac043ea58b3c4d">  156</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#ae9b5c1be61a24d5fcfac043ea58b3c4d">getD</a>(<a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; D)<span class="keyword"> const </span>{ D.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(_D);};</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a5ded25ce31fdefc324bf94e1a785420d">  157</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classspams_1_1Trainer.html#a5ded25ce31fdefc324bf94e1a785420d">getIter</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _itercount; };</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keyword">explicit</span> <a class="code" href="classspams_1_1Trainer.html">Trainer&lt;T&gt;</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Trainer.html">Trainer&lt;T&gt;</a>&amp; trainer);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="classspams_1_1Trainer.html">Trainer&lt;T&gt;</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="classspams_1_1Trainer.html">Trainer&lt;T&gt;</a>&amp; trainer);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordtype">void</span> cleanDict(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; G,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a> = <span class="keyword">false</span>,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22d">constraint_type_D</a> <a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> = <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>, <span class="keyword">const</span> T <a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a> = 0, </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keyword">const</span> T <a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a> = 0,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keyword">const</span> T maxCorrel =</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            0.999999);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordtype">void</span> cleanDict(<a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; G);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">  176</a></span>&#160;      <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">  177</a></span>&#160;      <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">  178</a></span>&#160;      <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">  179</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">_k</a>;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">  180</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>;</div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">  181</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>;</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">  182</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">  183</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;};</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a2e6f0eeb0317dbfca23a5d293890d7ae">  187</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classspams_1_1Trainer.html#a2e6f0eeb0317dbfca23a5d293890d7ae">Trainer&lt;T&gt;::Trainer</a>() : _k(0), _initialDict(false),</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   _itercount(0), _batchsize(256) { </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>=1;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> =  <a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="utils_8h.html#a8b5173357adb02a86c027316e0acdfa0">MAX_THREADS</a>,omp_get_num_procs());</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>=floor(<a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>*(<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>+1)/2);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   };</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a940dc2583704d8363457e2d0411754ee">  197</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classspams_1_1Trainer.html#a2e6f0eeb0317dbfca23a5d293890d7ae">Trainer&lt;T&gt;::Trainer</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> k, <span class="keyword">const</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">int</span> batchsize, <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_THREADS) : <a class="code" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">_k</a>(k), </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>(false), <a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>(0),<a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>(batchsize), </div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>(NUM_THREADS) { </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> == -1) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>=1;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> =  <a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="utils_8h.html#a8b5173357adb02a86c027316e0acdfa0">MAX_THREADS</a>,omp_get_num_procs());</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   };</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a6d8f3b15fc4096208c67dee2cf39e0f7">  210</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classspams_1_1Trainer.html#a2e6f0eeb0317dbfca23a5d293890d7ae">Trainer&lt;T&gt;::Trainer</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; D, </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> batchsize, <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_THREADS) : <a class="code" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">_k</a>(D.n()),</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     <a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>(true),<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>(0),<a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>(batchsize),</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>(NUM_THREADS) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.copy(D);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.resize(D.<a class="code" href="classspams_1_1Matrix.html#ae11862be7b7cad422d3dbfc708f05e20">n</a>(),D.<a class="code" href="classspams_1_1Matrix.html#ae11862be7b7cad422d3dbfc708f05e20">n</a>());</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.resize(D.<a class="code" href="classspams_1_1Matrix.html#a240b3db2f487255b636f71726f24e108">m</a>(),D.<a class="code" href="classspams_1_1Matrix.html#ae11862be7b7cad422d3dbfc708f05e20">n</a>());</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> == -1) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>=1;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> =  <a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="utils_8h.html#a8b5173357adb02a86c027316e0acdfa0">MAX_THREADS</a>,omp_get_num_procs());</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a044abd77633c9eda24c7024dc45e691f">  226</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classspams_1_1Trainer.html#a2e6f0eeb0317dbfca23a5d293890d7ae">Trainer&lt;T&gt;::Trainer</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; A, <span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      B, <span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; D, <span class="keyword">const</span> <span class="keywordtype">int</span> itercount, <span class="keyword">const</span> <span class="keywordtype">int</span> batchsize, </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_THREADS) : <a class="code" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">_k</a>(D.n()),<a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>(true),<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>(itercount),</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>(batchsize),</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>(NUM_THREADS) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.copy(D);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.copy(A);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.copy(B);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> == -1) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>=1;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a> =  <a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="utils_8h.html#a8b5173357adb02a86c027316e0acdfa0">MAX_THREADS</a>,omp_get_num_procs());</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   };</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">  243</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">Trainer&lt;T&gt;::cleanDict</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; G, </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> posD,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22d">constraint_type_D</a> modeD, <span class="keyword">const</span> T gamma1,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keyword">const</span> T gamma2,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keyword">const</span> T maxCorrel) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keywordtype">int</span> sparseD = modeD == <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da342d29879de6e86977d74fe023a04dbf">L1L2</a> ? 2 : 6;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> k = <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.n();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.m();</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> M = X.<a class="code" href="classspams_1_1Data.html#aece44c8006c18b63ec4f10ab03b933de">n</a>();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   T* <span class="keyword">const</span> pr_G=G.<a class="code" href="classspams_1_1Matrix.html#a7155100cf149c9325423fbf9cf848909">rawX</a>();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> aleat(n);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> col(n);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;k; ++i) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">//pr_G[i*k+i] += 1e-10;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i; j&lt;k; ++j) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         <span class="keywordflow">if</span> ((j &gt; i &amp;&amp; <a class="code" href="namespacespams.html#a6e0c56710b83e6ea3b2a757f8d202466">abs</a>(pr_G[i*k+j])/sqrt(pr_G[i*k+i]*pr_G[j*k+j]) &gt; maxCorrel) ||</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               (j == i &amp;&amp; <a class="code" href="namespacespams.html#a6e0c56710b83e6ea3b2a757f8d202466">abs</a>(pr_G[i*k+j]) &lt; 1e-4)) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ind = random() % M;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> d, g;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(j,d);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            X.<a class="code" href="classspams_1_1Data.html#ac7e5752efa8ffe96a571651c97e682d6">getData</a>(col,ind);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            d.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(col);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">if</span> (modeD != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;               aleat.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(d);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;               aleat.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(d,T(1.0),sparseD,gamma1,gamma2,T(2.0),posD);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;               <span class="keywordflow">if</span> (posD) d.<a class="code" href="classspams_1_1Vector.html#a699acc9e95b317b4f95950ecd33150bb">thrsPos</a>();</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;               d.<a class="code" href="classspams_1_1Vector.html#a9e9c791ed2afa83e0a0d3e6aa8f372ed">normalize</a>();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            G.<a class="code" href="classspams_1_1Matrix.html#acd98d17dc3e849239867785bf8c02e92">refCol</a>(j,g);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.multTrans(d,g);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l&lt;<a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.n(); ++l)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;               pr_G[l*k+j] = pr_G[j*k+l];</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a53c0ff9afac45172dfa5c5d25e75d1ea">  284</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">Trainer&lt;T&gt;::cleanDict</a>(<a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; G) {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> k = <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.n();</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.m();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   T* <span class="keyword">const</span> pr_G=G.<a class="code" href="classspams_1_1Matrix.html#a7155100cf149c9325423fbf9cf848909">rawX</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;k; ++i) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      pr_G[i*k+i] += 1e-10;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#ac0fcddf0150534ca1b6f332aa9673d1a">  295</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#ac0fcddf0150534ca1b6f332aa9673d1a">Trainer&lt;T&gt;::train</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, <span class="keyword">const</span> <a class="code" href="structspams_1_1ParamDictLearn.html">ParamDictLearn&lt;T&gt;</a>&amp; param) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   T rho = param.<a class="code" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">rho</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   T t0 = param.<a class="code" href="structspams_1_1ParamDictLearn.html#a85408522813cb8c29e03342dc29fa907">t0</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordtype">int</span> sparseD = param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> == <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da342d29879de6e86977d74fe023a04dbf">L1L2</a> ? 2 : param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> == L1L2MU ? 7 : 6;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordtype">int</span> NUM_THREADS=<a class="code" href="namespacespams.html#a70671a263b259b8fcae010568dc63009">init_omp</a>(<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;num param iterD: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a> &lt;&lt; endl;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">batch</a>) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Batch Mode&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#aad7025532886772f710023fb22cd5476">stochastic</a>) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Stochastic Gradient. rho : &quot;</span> &lt;&lt; rho &lt;&lt; <span class="stringliteral">&quot;, t0 : &quot;</span> &lt;&lt; t0 &lt;&lt; endl;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a> == <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a7e1c9255473878601d75beb52bf2ee0f">AUTO</a>) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Online Dictionary Learning with no parameter &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a> == <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a158572eef9ce280536fbc2e295eeac0a">PARAM1</a>) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Online Dictionary Learning with parameters: &quot;</span> &lt;&lt; t0 &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; rho &lt;&lt; endl;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Online Dictionary Learning with exponential decay t0: &quot;</span> &lt;&lt; t0 &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; rho &lt;&lt; endl;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;         }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Positivity constraints on D activated&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a>) </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Positivity constraints on alpha activated&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) cout &lt;&lt; <span class="stringliteral">&quot;Sparse dictionaries, mode: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> &lt;&lt; <span class="stringliteral">&quot;, gamma1: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a> &lt;&lt; <span class="stringliteral">&quot;, gamma2: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a> &lt;&lt; endl;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;mode Alpha &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> &lt;&lt; endl;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>) cout &lt;&lt; <span class="stringliteral">&quot;Cleaning activated &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#af11f236e8c493294894766235e7a25c8">log</a> &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">logName</a>) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;log activated &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         cerr &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">logName</a> &lt;&lt; endl;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> == <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3">PENALTY</a> &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>==0 &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">lambda2</a> &gt; 0 &amp;&amp; !param.<a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a>)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;L2 solver is used&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a> &gt; 0)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Retraining from iteration &quot;</span> &lt;&lt; <a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a> &lt;&lt; endl;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      flush(cout);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> M = X.<a class="code" href="classspams_1_1Data.html#aece44c8006c18b63ec4f10ab03b933de">n</a>();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> K = <a class="code" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">_k</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> n = X.<a class="code" href="classspams_1_1Data.html#aec2167cbfbd7cb3f3f7d42407a40193a">m</a>();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> L = param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> == <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178a25eec9a8e678cd0e6dc5a848c599f7b4">SPARSITY</a> ? <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>) : </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> == <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3">PENALTY</a> &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a> == 0 &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">lambda2</a> &gt; 0 &amp;&amp; !param.<a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a> ? K : <a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(n,K);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> batchsize= param.<a class="code" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">batch</a> ? M : <a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>,M);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>) {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;batch size: &quot;</span> &lt;&lt; batchsize &lt;&lt; endl;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;L: &quot;</span> &lt;&lt; L &lt;&lt; endl;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;lambda: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a> &lt;&lt; endl;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;mode: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> &lt;&lt; endl;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      flush(cout);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.m() != n || <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.n() != K) </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   srandom(0);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> col(n);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.resize(n,K);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;K; ++i) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> ind = random() % M;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> d;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(i,d);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         X.<a class="code" href="classspams_1_1Data.html#ac7e5752efa8ffe96a571651c97e682d6">getData</a>(col,ind);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;         d.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(col);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;*****Online Dictionary Learning*****&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      flush(cout);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> tmp(n);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;K; ++i) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> d;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(i,d);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;         tmp.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(d);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         tmp.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(d,T(1.0),sparseD,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;               param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>,T(2.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.thrsPos();</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.normalize();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="keywordtype">int</span> count=0;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="keywordtype">int</span> countPrev=0;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   T scalt0 =  abs&lt;T&gt;(t0);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a> == 0) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.resize(K,K);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.setZeros();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.resize(n,K);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.setZeros();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (!param.<a class="code" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">batch</a>) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.setDiag(scalt0);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.copy(<a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.scal(scalt0);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">//Matrix&lt;T&gt; G(K,K);</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> Borig(n,K);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> Aorig(K,K);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> Bodd(n,K);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> Aodd(K,K);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> Beven(n,K);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> Aeven(K,K);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <a class="code" href="classspams_1_1SpVector.html">SpVector&lt;T&gt;</a>* spcoeffT=<span class="keyword">new</span> <a class="code" href="classspams_1_1SpVector.html">SpVector&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>* DtRT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>* XT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* BT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* AT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* GsT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* GaT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* invGsT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* workT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>* uT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>[<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>];</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>; ++i) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      spcoeffT[i].<a class="code" href="classspams_1_1SpVector.html#a972fb20fab0fe4c086067811d26cefe3">resize</a>(K);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      DtRT[i].<a class="code" href="classspams_1_1Vector.html#ab453b8b1a7e4aa9892b886d2854d6bf7">resize</a>(K);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      XT[i].<a class="code" href="classspams_1_1Vector.html#ab453b8b1a7e4aa9892b886d2854d6bf7">resize</a>(n);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      BT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(n,K);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      BT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      AT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(K,K);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      AT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      GsT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(L,L);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      GsT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      invGsT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(L,L);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      invGsT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      GaT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(K,L);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      GaT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      workT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(K,3);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      workT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      uT[i].<a class="code" href="classspams_1_1Vector.html#ab453b8b1a7e4aa9892b886d2854d6bf7">resize</a>(L);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      uT[i].<a class="code" href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">setZeros</a>();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <a class="code" href="classspams_1_1Timer.html">Timer</a> time, time2;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   time.<a class="code" href="classspams_1_1Timer.html#abfee07295de96dcb1751142d34eceab6">start</a>();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   srandom(0);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;int&gt;</a> perm;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   perm.<a class="code" href="classspams_1_1Vector.html#a412980373e7341251055f7464659ea5d">randperm</a>(M);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   Aodd.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   Bodd.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   Aeven.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   Beven.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   Aorig.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(<a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   Borig.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(<a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordtype">int</span> JJ = param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">iter</a> &lt; 0 ? 100000000 : param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">iter</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordtype">bool</span> even=<span class="keyword">true</span>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keywordtype">int</span> last_written=-40;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keywordflow">for</span> (i = 0; i&lt;JJ; ++i) {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a> &amp;&amp; i%100==0) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Iteration: &quot;</span> &lt;&lt; i &lt;&lt; endl;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         flush(cout);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      time.<a class="code" href="classspams_1_1Timer.html#ae4eab94d9ce559f650fe6502b13f364e">stop</a>();</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">iter</a> &lt; 0 &amp;&amp; </div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            time.<a class="code" href="classspams_1_1Timer.html#a6daec457c61de062e6dab52f46e7fb30">getElapsed</a>() &gt; T(-param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">iter</a>)) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#af11f236e8c493294894766235e7a25c8">log</a>) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;         <span class="keywordtype">int</span> seconds=<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(floor(log(time.<a class="code" href="classspams_1_1Timer.html#a6daec457c61de062e6dab52f46e7fb30">getElapsed</a>())*5));</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;         <span class="keywordflow">if</span> (seconds &gt; last_written) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            last_written++;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            sprintf(buffer_string,<span class="stringliteral">&quot;%s_%d.log&quot;</span>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">logName</a>,</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                  last_written+40);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="namespacespams.html#a4dfc0b17e355f0d776319be5cdb5eead">writeLog</a>(<a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>,T(time.<a class="code" href="classspams_1_1Timer.html#a6daec457c61de062e6dab52f46e7fb30">getElapsed</a>()),i,buffer_string);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            fprintf(stderr,<span class="stringliteral">&quot;\r%d&quot;</span>,i);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;         }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      time.<a class="code" href="classspams_1_1Timer.html#abfee07295de96dcb1751142d34eceab6">start</a>();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      </div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> G;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.XtX(G);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>) </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;         this-&gt;<a class="code" href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">cleanDict</a>(X,G,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;               param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      G.<a class="code" href="classspams_1_1Matrix.html#a4c86de43d797702b4ae3aa5fb0178b7a">addDiag</a>(<a class="code" href="utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">lambda2</a>,1e-10));</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">for</span> (j = 0; j&lt;<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>; ++j) {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;         AT[j].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;         BT[j].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#pragma omp parallel for private(j)</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">for</span> (j = 0; j&lt;batchsize; ++j) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;         <span class="keywordtype">int</span> numT=omp_get_thread_num();</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;         <span class="keywordtype">int</span> numT=0;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> index=perm[(j+i*batchsize) % M];</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>&amp; Xj = XT[numT];</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         <a class="code" href="classspams_1_1SpVector.html">SpVector&lt;T&gt;</a>&amp; spcoeffj = spcoeffT[numT];</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>&amp; DtRj = DtRT[numT];</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;         <span class="comment">//X.refCol(index,Xj);</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;         X.<a class="code" href="classspams_1_1Data.html#ac7e5752efa8ffe96a571651c97e682d6">getData</a>(Xj,index);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">whiten</a>) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a>) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;               <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> mean(4);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;               Xj.whiten(mean,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;               Xj.whiten(X.<a class="code" href="classspams_1_1Data.html#a00357a364f37d56c2e6bff99b92a8ac5">V</a>());</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;         }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.multTrans(Xj,DtRj);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; Gs = GsT[numT];</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;         <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; Ga = GaT[numT];</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;         <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; invGs = invGsT[numT];</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; work= workT[numT];</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>&amp; u = uT[numT];</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;int&gt;</a> ind;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> coeffs_sparse;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         spcoeffj.<a class="code" href="classspams_1_1SpVector.html#a9282f22842d7bf2e57891171dd179244">setL</a>(L);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;         spcoeffj.<a class="code" href="classspams_1_1SpVector.html#a38540ea89ef9127b7cc0f5627815fa90">refIndices</a>(ind);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;         spcoeffj.<a class="code" href="classspams_1_1SpVector.html#a2bfca57075fe416dbb99937aa1f78b5d">refVal</a>(coeffs_sparse);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         T normX=Xj.nrm2sq();</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         coeffs_sparse.<a class="code" href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">setZeros</a>();</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> &lt; <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178a25eec9a8e678cd0e6dc5a848c599f7b4">SPARSITY</a>) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> == <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3">PENALTY</a> &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>==0 &amp;&amp; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">lambda2</a> &gt; 0 &amp;&amp; !param.<a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a>) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;               <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; GG = G;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               u.<a class="code" href="classspams_1_1Vector.html#a27ebb7c958e5c30a41876ed3425d867a">set</a>(0);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;               GG.<a class="code" href="classspams_1_1Matrix.html#a17240502f70436419bb12d13b2eaca4d">conjugateGradient</a>(DtRj,u,1e-4,2*K);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k&lt;K; ++k) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                  ind[k]=k;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                  coeffs_sparse[k]=u[k];</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;               }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;               <a class="code" href="namespacespams.html#a11a263a784992cfa353524e6a621ccaf">coreLARS2</a>(DtRj,G,Gs,Ga,invGs,u,coeffs_sparse,ind,work,normX,param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">posAlpha</a>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> == <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178a25eec9a8e678cd0e6dc5a848c599f7b4">SPARSITY</a>) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;               <a class="code" href="namespacespams.html#a4c2c75f7becf58d5830733655a400da1">coreORMPB</a>(DtRj,G,ind,coeffs_sparse,normX,L,T(0.0),T(0.0));</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a>==<a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178ad0f58b113b123f31880b2605fa2219fa">L2ERROR2</a>) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;               <a class="code" href="namespacespams.html#a4c2c75f7becf58d5830733655a400da1">coreORMPB</a>(DtRj,G,ind,coeffs_sparse,normX,L,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>,T(0.0));</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;               <a class="code" href="namespacespams.html#a4c2c75f7becf58d5830733655a400da1">coreORMPB</a>(DtRj,G,ind,coeffs_sparse,normX,L,T(0.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;         }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         <span class="keywordtype">int</span> count2=0;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k&lt;L; ++k) </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">if</span> (ind[k] == -1) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;               ++count2;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;         <a class="code" href="namespacespams.html#ad532d3bc49b745e3ce2e2677689b1769">sort</a>(ind.<a class="code" href="classspams_1_1Vector.html#a528481f78aeaac8fedbd926d432e87ed">rawX</a>(),coeffs_sparse.<a class="code" href="classspams_1_1Vector.html#a528481f78aeaac8fedbd926d432e87ed">rawX</a>(),0,count2-1);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;         spcoeffj.<a class="code" href="classspams_1_1SpVector.html#a9282f22842d7bf2e57891171dd179244">setL</a>(count2);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;         AT[numT].<a class="code" href="classspams_1_1Matrix.html#a89f292c8487e0acf48b5adcad2f9c462">rank1Update</a>(spcoeffj);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         BT[numT].<a class="code" href="classspams_1_1Matrix.html#a89f292c8487e0acf48b5adcad2f9c462">rank1Update</a>(Xj,spcoeffj);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">batch</a>) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.setZeros();</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.setZeros();</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         <span class="keywordflow">for</span> (j = 0; j&lt;<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>; ++j) {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.add(AT[j]);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.add(BT[j]);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> di, ai,bi;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> newd(n);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         <span class="keywordflow">for</span> (j = 0; j&lt;param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a>; ++j) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k&lt;K; ++k) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>[k*K+k] &gt; 1e-6) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(k,di);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.refCol(k,ai);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.refCol(k,bi);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.mult(ai,newd,T(-1.0));</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">add</a>(bi);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#a62c077f4493d82fb1ba891125e1b56c5">scal</a>(T(1.0)/<a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>[k*K+k]);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">add</a>(di);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                  <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                     newd.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(di,T(1.0),</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                           sparseD,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                           param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>,T(2.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                     <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) newd.<a class="code" href="classspams_1_1Vector.html#a699acc9e95b317b4f95950ecd33150bb">thrsPos</a>();</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                     newd.<a class="code" href="classspams_1_1Vector.html#aae6df4c4960c416f68c2bd06d757ccd0">normalize2</a>();</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                     di.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(newd);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                  }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(k,di);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                  di.<a class="code" href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">setZeros</a>();</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;               }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;         }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#aad7025532886772f710023fb22cd5476">stochastic</a>) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.setZeros();</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.setZeros();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;         <span class="keywordflow">for</span> (j = 0; j&lt;<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>; ++j) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.add(AT[j]);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.add(BT[j]);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;         }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.mult(<a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>,<a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>,<span class="keyword">false</span>,<span class="keyword">false</span>,T(-1.0),T(1.0));</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         T step_grad=rho/T(t0+batchsize*(i+1));</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.add(<a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>,step_grad);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> dj;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> dnew(n);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">for</span> (j = 0; j&lt;K; ++j) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;               <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(j,dj);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;               dnew.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(dj);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;               dnew.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(dj,T(1.0),sparseD,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                     param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>,T(2.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keywordflow">for</span> (j = 0; j&lt;K; ++j) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;               <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(j,dj);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) dj.<a class="code" href="classspams_1_1Vector.html#a699acc9e95b317b4f95950ecd33150bb">thrsPos</a>();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;               dj.<a class="code" href="classspams_1_1Vector.html#aae6df4c4960c416f68c2bd06d757ccd0">normalize2</a>();</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;         <span class="keywordtype">int</span> epoch = (((i+1) % M)*batchsize) / M;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;         <span class="keywordflow">if</span> ((even &amp;&amp; ((epoch % 2) == 1)) || (!even &amp;&amp; ((epoch % 2) == 0))) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            Aodd.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(Aeven);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            Bodd.<a class="code" href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">copy</a>(Beven);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            Aeven.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            Beven.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            count=countPrev;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            countPrev=0;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            even=!even;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;         }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         <span class="keywordtype">int</span> ii=<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>+i;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="keywordtype">int</span> num_elem=<a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(2*M, ii &lt; batchsize ? ii*batchsize :</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;               batchsize*batchsize+ii-batchsize);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         T scal2=T(T(1.0)/batchsize);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;         T scal;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         <span class="keywordtype">int</span> totaliter=<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>+count;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a> == <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309acdbda3a527ec2818f5c5fcfd21ab3bdb">PARAM2</a>) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            scal=param.<a class="code" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">rho</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a> == <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a158572eef9ce280536fbc2e295eeac0a">PARAM1</a>) {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            scal=<a class="code" href="utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.95,pow(T(totaliter)/T(totaliter+1),-rho));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            scal = T(<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>+num_elem+1-</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                  batchsize)/T(<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>+num_elem+1);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;         Aeven.<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;         Beven.<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;         Aodd.<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;         Bodd.<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         <span class="keywordflow">if</span> ((<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a> &gt; 0 &amp;&amp; i*batchsize &lt; M) </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;               || (<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a> == 0 &amp;&amp; t0 != 0 &amp;&amp; </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                  i*batchsize &lt; 10000)) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            Aorig.<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            Borig.<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.copy(Aorig);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.copy(Borig);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.setZeros();</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.setZeros();</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;         }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;         <span class="keywordflow">for</span> (j = 0; j&lt;<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>; ++j) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            Aeven.<a class="code" href="classspams_1_1Matrix.html#a98d75501c22f06741ab695a43b9581d2">add</a>(AT[j],scal2);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            Beven.<a class="code" href="classspams_1_1Matrix.html#a98d75501c22f06741ab695a43b9581d2">add</a>(BT[j],scal2);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;         }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.add(Aodd);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.add(Aeven);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.add(Bodd);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.add(Beven);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         ++count;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;         ++countPrev;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> di, ai,bi;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> newd(n);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         <span class="keywordflow">for</span> (j = 0; j&lt;param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a>; ++j) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k&lt;K; ++k) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>[k*K+k] &gt; 1e-6) {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(k,di);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>.refCol(k,ai);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">_B</a>.refCol(k,bi);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.mult(ai,newd,T(-1.0));</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">add</a>(bi);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#a62c077f4493d82fb1ba891125e1b56c5">scal</a>(T(1.0)/<a class="code" href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">_A</a>[k*K+k]);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">add</a>(di);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                  <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                     newd.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(di,T(1.0),sparseD,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                           param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>,T(2.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                     <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) newd.<a class="code" href="classspams_1_1Vector.html#a699acc9e95b317b4f95950ecd33150bb">thrsPos</a>();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                     newd.<a class="code" href="classspams_1_1Vector.html#aae6df4c4960c416f68c2bd06d757ccd0">normalize2</a>();</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                     di.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(newd);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                  }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a> &amp;&amp; </div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                     ((<a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a>+i)*batchsize) &gt; 10000) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                  <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(k,di);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                  di.<a class="code" href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">setZeros</a>();</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;               }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;         }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <a class="code" href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">_itercount</a> += i;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      time.<a class="code" href="classspams_1_1Timer.html#a0a4245820f6e390c5480878473c9407a">printElapsed</a>();</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="keyword">delete</span>[](spcoeffT);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="keyword">delete</span>[](DtRT);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keyword">delete</span>[](AT);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <span class="keyword">delete</span>[](BT);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="keyword">delete</span>[](GsT);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keyword">delete</span>[](invGsT);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="keyword">delete</span>[](GaT);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <span class="keyword">delete</span>[](uT);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keyword">delete</span>[](XT);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   <span class="keyword">delete</span>[](workT);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;};</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="namespacespams.html#a4dfc0b17e355f0d776319be5cdb5eead">  717</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacespams.html#a4dfc0b17e355f0d776319be5cdb5eead">writeLog</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>&amp; D, <span class="keyword">const</span> T time, <span class="keywordtype">int</span> iter, </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordtype">char</span>* name) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   std::ofstream f;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   f.precision(12);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   f.flags(std::ios_base::scientific);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   f.open(name, ofstream::trunc);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   f &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; iter &lt;&lt; std::endl;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;D.<a class="code" href="classspams_1_1Matrix.html#ae11862be7b7cad422d3dbfc708f05e20">n</a>(); ++i) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j&lt;D.<a class="code" href="classspams_1_1Matrix.html#a240b3db2f487255b636f71726f24e108">m</a>(); ++j) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;         f &lt;&lt; D[i*D.<a class="code" href="classspams_1_1Matrix.html#a240b3db2f487255b636f71726f24e108">m</a>()+j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      f &lt;&lt; std::endl;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   f &lt;&lt; std::endl;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   f.close();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;};</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="classspams_1_1Trainer.html#a39f55ac15d389f6f9d1a31cecea355a7">  736</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspams_1_1Trainer.html#a39f55ac15d389f6f9d1a31cecea355a7">Trainer&lt;T&gt;::trainOffline</a>(<span class="keyword">const</span> <a class="code" href="classspams_1_1Data.html">Data&lt;T&gt;</a>&amp; X, </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keyword">const</span> <a class="code" href="structspams_1_1ParamDictLearn.html">ParamDictLearn&lt;T&gt;</a>&amp; param) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   <span class="keywordtype">int</span> sparseD = param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> == <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da342d29879de6e86977d74fe023a04dbf">L1L2</a> ? 2 : 6;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <span class="keywordtype">int</span> J = param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">iter</a>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   <span class="keywordtype">int</span> batch_size= <a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordtype">int</span> batchsize= <a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   <span class="keywordtype">int</span> NUM_THREADS=<a class="code" href="namespacespams.html#a70671a263b259b8fcae010568dc63009">init_omp</a>(<a class="code" href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">_NUM_THREADS</a>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> n = X.<a class="code" href="classspams_1_1Data.html#aec2167cbfbd7cb3f3f7d42407a40193a">m</a>();</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> K = <a class="code" href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">_k</a>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> M = X.<a class="code" href="classspams_1_1Data.html#aece44c8006c18b63ec4f10ab03b933de">n</a>();</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;*****Offline Dictionary Learning*****&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   fprintf(stderr,<span class="stringliteral">&quot;num param iterD: %d\n&quot;</span>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a>);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;batch size: &quot;</span> &lt;&lt; <a class="code" href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">_batchsize</a> &lt;&lt; endl;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;lambda: &quot;</span> &lt;&lt; param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a> &lt;&lt; endl;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;X: &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; M &lt;&lt; endl;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;D: &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; K &lt;&lt; endl;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   flush(cout);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   srandom(0);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> col(n);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>) {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.resize(n,K);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;K; ++i) {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> ind = random() % M;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> d;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(i,d);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;         X.<a class="code" href="classspams_1_1Data.html#ac7e5752efa8ffe96a571651c97e682d6">getData</a>(col,ind);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;         d.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(col);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">_initialDict</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> tmp(n);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;K; ++i) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> d;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(i,d);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;         tmp.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(d);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;         tmp.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(d,T(1.0),sparseD,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;               param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>,T(2.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.thrsPos();</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.normalize();</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> G(K,K);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> coeffs(K,M);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   coeffs.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> B(n,K);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a> A(K,K);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <a class="code" href="classspams_1_1SpVector.html">SpVector&lt;T&gt;</a>* spcoeffT=<span class="keyword">new</span> <a class="code" href="classspams_1_1SpVector.html">SpVector&lt;T&gt;</a>[NUM_THREADS];</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>* DtRT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>[NUM_THREADS];</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>* coeffsoldT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>[NUM_THREADS];</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* BT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[NUM_THREADS];</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>* AT=<span class="keyword">new</span> <a class="code" href="classspams_1_1Matrix.html">Matrix&lt;T&gt;</a>[NUM_THREADS];</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;NUM_THREADS; ++i) {</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      spcoeffT[i].<a class="code" href="classspams_1_1SpVector.html#a972fb20fab0fe4c086067811d26cefe3">resize</a>(K);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      DtRT[i].<a class="code" href="classspams_1_1Vector.html#ab453b8b1a7e4aa9892b886d2854d6bf7">resize</a>(K);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      coeffsoldT[i].<a class="code" href="classspams_1_1Vector.html#ab453b8b1a7e4aa9892b886d2854d6bf7">resize</a>(K);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      BT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(n,K);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      BT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      AT[i].<a class="code" href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">resize</a>(K,K);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      AT[i].<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <a class="code" href="classspams_1_1Timer.html">Timer</a> time;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   time.<a class="code" href="classspams_1_1Timer.html#abfee07295de96dcb1751142d34eceab6">start</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   srandom(0);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;int&gt;</a> perm;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   perm.<a class="code" href="classspams_1_1Vector.html#a412980373e7341251055f7464659ea5d">randperm</a>(M);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   <span class="keywordtype">int</span> JJ = J &lt; 0 ? 100000000 : J;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> weights(M);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   weights.<a class="code" href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">setZeros</a>();</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;JJ; ++i) {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">if</span> (J &lt; 0 &amp;&amp; time.<a class="code" href="classspams_1_1Timer.html#a6daec457c61de062e6dab52f46e7fb30">getElapsed</a>() &gt; T(-J)) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.XtX(G);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>) </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;         this-&gt;<a class="code" href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">cleanDict</a>(X,G,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;               param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#pragma omp parallel for private(j)</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">for</span> (j = 0; j&lt;batch_size; ++j) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;         <span class="keywordtype">int</span> numT=omp_get_thread_num();</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;         <span class="keywordtype">int</span> numT=0;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> ind=perm[(j+i*batch_size) % M];</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> Xj, coeffj;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;         <a class="code" href="classspams_1_1SpVector.html">SpVector&lt;T&gt;</a>&amp; spcoeffj = spcoeffT[numT];</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>&amp; DtRj = DtRT[numT];</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;         <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a>&amp; oldcoeffj = coeffsoldT[numT];</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;         X.<a class="code" href="classspams_1_1Data.html#ac7e5752efa8ffe96a571651c97e682d6">getData</a>(Xj,ind);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">whiten</a>) {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a>) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;               <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> mean(4);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;               Xj.whiten(mean,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">pattern</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;               Xj.whiten(X.<a class="code" href="classspams_1_1Data.html#a00357a364f37d56c2e6bff99b92a8ac5">V</a>());</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;         }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         coeffs.<a class="code" href="classspams_1_1Matrix.html#acd98d17dc3e849239867785bf8c02e92">refCol</a>(ind,coeffj);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;         oldcoeffj.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(coeffj);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;         <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.multTrans(Xj,DtRj);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         coeffj.toSparse(spcoeffj);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;         G.<a class="code" href="classspams_1_1Matrix.html#a1df29954e4238f95d6ff5168c5e2dbf9">mult</a>(spcoeffj,DtRj,T(-1.0),T(1.0));</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">mode</a> == <a class="code" href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3">PENALTY</a>) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <a class="code" href="namespacespams.html#aa437c45eb6500e07693bdec9305fd36e">coreIST</a>(G,DtRj,coeffj,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>,200,T(1e-3));</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            T normX = Xj.nrm2sq();</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <a class="code" href="namespacespams.html#a0f6a5c694f147729b4c98d2670903683">coreISTconstrained</a>(G,DtRj,coeffj,normX,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">lambda</a>,200,T(1e-3));</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;         oldcoeffj.<a class="code" href="classspams_1_1Vector.html#ae7a47651f6c2a53283e89dbe0787e387">toSparse</a>(spcoeffj);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         AT[numT].<a class="code" href="classspams_1_1Matrix.html#a89f292c8487e0acf48b5adcad2f9c462">rank1Update</a>(spcoeffj,-weights[ind]);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;         coeffj.toSparse(spcoeffj);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;         AT[numT].<a class="code" href="classspams_1_1Matrix.html#a89f292c8487e0acf48b5adcad2f9c462">rank1Update</a>(spcoeffj);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;         weights[ind]++;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         oldcoeffj.<a class="code" href="classspams_1_1Vector.html#a62c077f4493d82fb1ba891125e1b56c5">scal</a>(weights[ind]);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         oldcoeffj.<a class="code" href="classspams_1_1Vector.html#a1c2a39e500bcdba32db98d75a4bd62ba">sub</a>(coeffj);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;         oldcoeffj.<a class="code" href="classspams_1_1Vector.html#ae7a47651f6c2a53283e89dbe0787e387">toSparse</a>(spcoeffj);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;         BT[numT].<a class="code" href="classspams_1_1Matrix.html#a89f292c8487e0acf48b5adcad2f9c462">rank1Update</a>(Xj,spcoeffj,T(-1.0));</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      A.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      B.<a class="code" href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">setZeros</a>();</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      T scal;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordtype">int</span> totaliter=i;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordtype">int</span> ii = i;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordtype">int</span> num_elem=<a class="code" href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(2*M, ii &lt; batchsize ? ii*batchsize :</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            batchsize*batchsize+ii-batchsize);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a> == <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309acdbda3a527ec2818f5c5fcfd21ab3bdb">PARAM2</a>) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;         scal=param.<a class="code" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">rho</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">modeParam</a> == <a class="code" href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a158572eef9ce280536fbc2e295eeac0a">PARAM1</a>) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;         scal=<a class="code" href="utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(0.95,pow(T(totaliter)/T(totaliter+1),-param.<a class="code" href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">rho</a>));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;         scal = T(num_elem+1-</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;               batchsize)/T(num_elem+1);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="keywordflow">for</span> (j = 0; j&lt;NUM_THREADS; ++j) {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;         A.<a class="code" href="classspams_1_1Matrix.html#a98d75501c22f06741ab695a43b9581d2">add</a>(AT[j]);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;         B.<a class="code" href="classspams_1_1Matrix.html#a98d75501c22f06741ab695a43b9581d2">add</a>(BT[j]);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;         AT[j].<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;         BT[j].<a class="code" href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">scal</a>(scal);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      weights.<a class="code" href="classspams_1_1Vector.html#a62c077f4493d82fb1ba891125e1b56c5">scal</a>(scal);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> di, ai,bi;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> newd(n);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">for</span> (j = 0; j&lt;param.<a class="code" href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">iter_updateD</a>; ++j) {</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k&lt;K; ++k) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">if</span> (A[k*K+k] &gt; 1e-6) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;               <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(k,di);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;               A.<a class="code" href="classspams_1_1Matrix.html#acd98d17dc3e849239867785bf8c02e92">refCol</a>(k,ai);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;               B.<a class="code" href="classspams_1_1Matrix.html#acd98d17dc3e849239867785bf8c02e92">refCol</a>(k,bi);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;               <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.mult(ai,newd,T(-1.0));</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;               newd.<a class="code" href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">add</a>(bi);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;               newd.<a class="code" href="classspams_1_1Vector.html#a62c077f4493d82fb1ba891125e1b56c5">scal</a>(T(1.0)/A[k*K+k]);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;               newd.<a class="code" href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">add</a>(di);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;               <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a> != <a class="code" href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">L2</a>) {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">sparseProject</a>(di,T(1.0),</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                        sparseD,param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                        param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>,T(2.0),param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                  <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>) newd.<a class="code" href="classspams_1_1Vector.html#a699acc9e95b317b4f95950ecd33150bb">thrsPos</a>();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                  newd.<a class="code" href="classspams_1_1Vector.html#aae6df4c4960c416f68c2bd06d757ccd0">normalize2</a>();</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                  di.<a class="code" href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">copy</a>(newd);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;               }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;               <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.refCol(k,di);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;               di.<a class="code" href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">setZeros</a>();</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;         }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">verbose</a>)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="classspams_1_1Vector.html">Vector&lt;T&gt;</a> l1norms;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        coeffs.<a class="code" href="classspams_1_1Matrix.html#abbf5e00180181e8c2ac82293f7efb477">norm_l1_rows</a>(l1norms);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordtype">double</span> sumL1=0.0;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> iii = 0; iii &lt; l1norms.<a class="code" href="classspams_1_1Vector.html#a7626e4ab4348e6d688fa375e0c47803f">n</a>(); iii += 1 ) </div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          sumL1 += l1norms[iii];</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;i = &quot;</span>&lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, coeffs sumL1 = &quot;</span> &lt;&lt; sumL1 &lt;&lt; std::endl &lt;&lt; std::flush;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      </div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <a class="code" href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">_D</a>.XtX(G);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   <span class="keywordflow">if</span> (param.<a class="code" href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">clean</a>) </div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      this-&gt;<a class="code" href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">cleanDict</a>(X,G,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">posD</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">modeD</a>,</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            param.<a class="code" href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">gamma1</a>,param.<a class="code" href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">gamma2</a>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   time.<a class="code" href="classspams_1_1Timer.html#a0a4245820f6e390c5480878473c9407a">printElapsed</a>();</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <span class="keyword">delete</span>[](spcoeffT);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="keyword">delete</span>[](DtRT);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   <span class="keyword">delete</span>[](AT);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   <span class="keyword">delete</span>[](BT);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <span class="keyword">delete</span>[](coeffsoldT);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;}</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="ttc" id="structspams_1_1ParamDictLearn_html_a793ea97b934e10224b9af0ea1b611bb8"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a793ea97b934e10224b9af0ea1b611bb8">spams::ParamDictLearn::clean</a></div><div class="ttdeci">bool clean</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00119">dicts.h:119</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_abbf5e00180181e8c2ac82293f7efb477"><div class="ttname"><a href="classspams_1_1Matrix.html#abbf5e00180181e8c2ac82293f7efb477">spams::Matrix::norm_l1_rows</a></div><div class="ttdeci">void norm_l1_rows(Vector&lt; T &gt; &amp;norms) const </div><div class="ttdoc">returns the linf norms of the columns </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02193">linalg.h:2193</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_aae6df4c4960c416f68c2bd06d757ccd0"><div class="ttname"><a href="classspams_1_1Vector.html#aae6df4c4960c416f68c2bd06d757ccd0">spams::Vector::normalize2</a></div><div class="ttdeci">void normalize2()</div><div class="ttdoc">normalize the vector </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l03128">linalg.h:3128</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a85408522813cb8c29e03342dc29fa907"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a85408522813cb8c29e03342dc29fa907">spams::ParamDictLearn::t0</a></div><div class="ttdeci">T t0</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00093">dicts.h:93</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a429b9f6ec1d269b300678167224144dd"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a429b9f6ec1d269b300678167224144dd">spams::ParamDictLearn::modeD</a></div><div class="ttdeci">constraint_type_D modeD</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00090">dicts.h:90</a></div></div>
<div class="ttc" id="namespacespams_html"><div class="ttname"><a href="namespacespams.html">spams</a></div><div class="ttdef"><b>Definition:</b> <a href="dag_8h_source.html#l00026">dag.h:26</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a89f292c8487e0acf48b5adcad2f9c462"><div class="ttname"><a href="classspams_1_1Matrix.html#a89f292c8487e0acf48b5adcad2f9c462">spams::Matrix::rank1Update</a></div><div class="ttdeci">void rank1Update(const Vector&lt; T &gt; &amp;vec1, const Vector&lt; T &gt; &amp;vec2, const T alpha=1.0)</div><div class="ttdoc">perform A &lt;- A + alpha*vec1*vec2&amp;#39; </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02384">linalg.h:2384</a></div></div>
<div class="ttc" id="classspams_1_1SpVector_html_a9282f22842d7bf2e57891171dd179244"><div class="ttname"><a href="classspams_1_1SpVector.html#a9282f22842d7bf2e57891171dd179244">spams::SpVector::setL</a></div><div class="ttdeci">void setL(const int L)</div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00960">linalg.h:960</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_ae1389a039a62d66fd347114f55a7b5d2"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#ae1389a039a62d66fd347114f55a7b5d2">spams::ParamDictLearn::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00085">dicts.h:85</a></div></div>
<div class="ttc" id="classspams_1_1Data_html_aec2167cbfbd7cb3f3f7d42407a40193a"><div class="ttname"><a href="classspams_1_1Data.html#aec2167cbfbd7cb3f3f7d42407a40193a">spams::Data::m</a></div><div class="ttdeci">virtual int m() const  =0</div></div>
<div class="ttc" id="namespacespams_html_a6027bf4fab21cb18ed41910cd8c1b22dad6b32f15ab6f3a04e312a1a07df12864"><div class="ttname"><a href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22dad6b32f15ab6f3a04e312a1a07df12864">spams::L1L2FL</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00041">dicts.h:41</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a4a08cf0ca0606b199d097a1b0d729b73"><div class="ttname"><a href="classspams_1_1Vector.html#a4a08cf0ca0606b199d097a1b0d729b73">spams::Vector::copy</a></div><div class="ttdeci">void copy(const Vector&lt; T &gt; &amp;x)</div><div class="ttdoc">make a copy of x </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02865">linalg.h:2865</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_af11f236e8c493294894766235e7a25c8"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#af11f236e8c493294894766235e7a25c8">spams::ParamDictLearn::log</a></div><div class="ttdeci">bool log</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00120">dicts.h:120</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a9e9c791ed2afa83e0a0d3e6aa8f372ed"><div class="ttname"><a href="classspams_1_1Vector.html#a9e9c791ed2afa83e0a0d3e6aa8f372ed">spams::Vector::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdoc">normalize the vector </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l03122">linalg.h:3122</a></div></div>
<div class="ttc" id="namespacespams_html_afe8df4f71af4664583edb16ea9e97178"><div class="ttname"><a href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178">spams::constraint_type</a></div><div class="ttdeci">constraint_type</div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l00088">decomp.h:88</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_aa8b5ad7aa031b620705cc99e7f830d83"><div class="ttname"><a href="classspams_1_1Vector.html#aa8b5ad7aa031b620705cc99e7f830d83">spams::Vector::sparseProject</a></div><div class="ttdeci">void sparseProject(Vector&lt; T &gt; &amp;out, const T thrs, const int mode=1, const T lambda1=0, const T lambda2=0, const T lambda3=0, const bool pos=false)</div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l03508">linalg.h:3508</a></div></div>
<div class="ttc" id="namespacespams_html_ab3efcaa595f15f3c4308049b7d83e309acdbda3a527ec2818f5c5fcfd21ab3bdb"><div class="ttname"><a href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309acdbda3a527ec2818f5c5fcfd21ab3bdb">spams::PARAM2</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00042">dicts.h:42</a></div></div>
<div class="ttc" id="namespacespams_html_a6027bf4fab21cb18ed41910cd8c1b22da342d29879de6e86977d74fe023a04dbf"><div class="ttname"><a href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da342d29879de6e86977d74fe023a04dbf">spams::L1L2</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00041">dicts.h:41</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a9a3142320341a669ee76089828ae1eef"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a9a3142320341a669ee76089828ae1eef">spams::ParamDictLearn::approx</a></div><div class="ttdeci">T approx</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00101">dicts.h:101</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a62c077f4493d82fb1ba891125e1b56c5"><div class="ttname"><a href="classspams_1_1Vector.html#a62c077f4493d82fb1ba891125e1b56c5">spams::Vector::scal</a></div><div class="ttdeci">void scal(const T a)</div><div class="ttdoc">scale the vector by a </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l03277">linalg.h:3277</a></div></div>
<div class="ttc" id="namespacespams_html_a0f6a5c694f147729b4c98d2670903683"><div class="ttname"><a href="namespacespams.html#a0f6a5c694f147729b4c98d2670903683">spams::coreISTconstrained</a></div><div class="ttdeci">void coreISTconstrained(const AbstractMatrix&lt; T &gt; &amp;G, Vector&lt; T &gt; &amp;DtR, Vector&lt; T &gt; &amp;coeffs, const T normX2, const T thrs, const int itermax=500, const T tol=0.5)</div><div class="ttdoc">coreIST constrained </div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l02113">decomp.h:2113</a></div></div>
<div class="ttc" id="classspams_1_1Timer_html_ae4eab94d9ce559f650fe6502b13f364e"><div class="ttname"><a href="classspams_1_1Timer.html#ae4eab94d9ce559f650fe6502b13f364e">spams::Timer::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdoc">stop the time </div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00149">utils.h:149</a></div></div>
<div class="ttc" id="namespacespams_html_a6b215b3081f6a7adc2ea70ffd53617d2"><div class="ttname"><a href="namespacespams.html#a6b215b3081f6a7adc2ea70ffd53617d2">spams::buffer_string</a></div><div class="ttdeci">static char buffer_string[50]</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00040">dicts.h:40</a></div></div>
<div class="ttc" id="classspams_1_1Data_html_a00357a364f37d56c2e6bff99b92a8ac5"><div class="ttname"><a href="classspams_1_1Data.html#a00357a364f37d56c2e6bff99b92a8ac5">spams::Data::V</a></div><div class="ttdeci">virtual int V() const  =0</div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a44ff379f95b63c10a7f2d99cc22ff271"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a44ff379f95b63c10a7f2d99cc22ff271">spams::ParamDictLearn::mu</a></div><div class="ttdeci">T mu</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00096">dicts.h:96</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_ac8f7d8f2a452d36da6d0d861d2390564"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#ac8f7d8f2a452d36da6d0d861d2390564">spams::ParamDictLearn::rho</a></div><div class="ttdeci">T rho</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00094">dicts.h:94</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a316d8bf5c94db4dad2164444e81e29bb"><div class="ttname"><a href="classspams_1_1Vector.html#a316d8bf5c94db4dad2164444e81e29bb">spams::Vector::add</a></div><div class="ttdeci">void add(const Vector&lt; T &gt; &amp;x, const T a=1.0)</div><div class="ttdoc">A &lt;- A + a*x. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l03029">linalg.h:3029</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a5ef058afc9bcfde5b6b0df7f9d3bc84d"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a5ef058afc9bcfde5b6b0df7f9d3bc84d">spams::ParamDictLearn::lambda2</a></div><div class="ttdeci">T lambda2</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00099">dicts.h:99</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a7bfc583509621dbe8fcead0f8b2c2e49"><div class="ttname"><a href="classspams_1_1Trainer.html#a7bfc583509621dbe8fcead0f8b2c2e49">spams::Trainer::_A</a></div><div class="ttdeci">Matrix&lt; T &gt; _A</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00176">dicts.h:176</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aac4cca3056a34999a22f29d729cc67eb"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aac4cca3056a34999a22f29d729cc67eb">spams::ParamDictLearn::balanceClasses</a></div><div class="ttdeci">bool balanceClasses</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00112">dicts.h:112</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a4c86de43d797702b4ae3aa5fb0178b7a"><div class="ttname"><a href="classspams_1_1Matrix.html#a4c86de43d797702b4ae3aa5fb0178b7a">spams::Matrix::addDiag</a></div><div class="ttdeci">void addDiag(const Vector&lt; T &gt; &amp;diag)</div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01506">linalg.h:1506</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a528481f78aeaac8fedbd926d432e87ed"><div class="ttname"><a href="classspams_1_1Vector.html#a528481f78aeaac8fedbd926d432e87ed">spams::Vector::rawX</a></div><div class="ttdeci">T * rawX() const </div><div class="ttdoc">returns a modifiable reference of the data, DANGEROUS </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00593">linalg.h:593</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a8dc7239415ba8e8e564662535e6e83bc"><div class="ttname"><a href="classspams_1_1Trainer.html#a8dc7239415ba8e8e564662535e6e83bc">spams::Trainer::_batchsize</a></div><div class="ttdeci">int _batchsize</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00182">dicts.h:182</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a6b4787f6567b015acb3780227147c76b"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a6b4787f6567b015acb3780227147c76b">spams::ParamDictLearn::~ParamDictLearn</a></div><div class="ttdeci">~ParamDictLearn()</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00085">dicts.h:85</a></div></div>
<div class="ttc" id="namespacespams_html_ac524233de7de47bc45f57cde5a2470d1"><div class="ttname"><a href="namespacespams.html#ac524233de7de47bc45f57cde5a2470d1">spams::vector_groups</a></div><div class="ttdeci">std::vector&lt; group &gt; vector_groups</div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00073">linalg.h:73</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a75086bc93d825bc9f11da03c3c9f019a"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a75086bc93d825bc9f11da03c3c9f019a">spams::ParamDictLearn::ThetaDiagPlus</a></div><div class="ttdeci">bool ThetaDiagPlus</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00108">dicts.h:108</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a8bb2db26e7441e4a1aaa4a35c1585366"><div class="ttname"><a href="classspams_1_1Trainer.html#a8bb2db26e7441e4a1aaa4a35c1585366">spams::Trainer::cleanDict</a></div><div class="ttdeci">void cleanDict(const Data&lt; T &gt; &amp;X, Matrix&lt; T &gt; &amp;G, const bool posD=false, const constraint_type_D modeD=L2, const T gamma1=0, const T gamma2=0, const T maxCorrel=0.999999)</div><div class="ttdoc">clean the dictionary </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00243">dicts.h:243</a></div></div>
<div class="ttc" id="namespacespams_html_ad532d3bc49b745e3ce2e2677689b1769"><div class="ttname"><a href="namespacespams.html#ad532d3bc49b745e3ce2e2677689b1769">spams::sort</a></div><div class="ttdeci">static void sort(int *irOut, T *prOut, int beg, int end)</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00141">misc.h:141</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aa127ffd44b0ea184eee15751f477cbf1"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aa127ffd44b0ea184eee15751f477cbf1">spams::ParamDictLearn::updateTheta</a></div><div class="ttdeci">bool updateTheta</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00123">dicts.h:123</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a50eff8c9bc2faa0946126e35dedb7e57"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a50eff8c9bc2faa0946126e35dedb7e57">spams::ParamDictLearn::ParamDictLearn</a></div><div class="ttdeci">ParamDictLearn()</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00046">dicts.h:46</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a5ded25ce31fdefc324bf94e1a785420d"><div class="ttname"><a href="classspams_1_1Trainer.html#a5ded25ce31fdefc324bf94e1a785420d">spams::Trainer::getIter</a></div><div class="ttdeci">int getIter() const </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00157">dicts.h:157</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a00f6bf2db5f2d9f517cb25bc0d38ff69"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a00f6bf2db5f2d9f517cb25bc0d38ff69">spams::ParamDictLearn::posAlpha</a></div><div class="ttdeci">bool posAlpha</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00089">dicts.h:89</a></div></div>
<div class="ttc" id="namespacespams_html_a4c2c75f7becf58d5830733655a400da1"><div class="ttname"><a href="namespacespams.html#a4c2c75f7becf58d5830733655a400da1">spams::coreORMPB</a></div><div class="ttdeci">void coreORMPB(Vector&lt; T &gt; &amp;RtD, const AbstractMatrix&lt; T &gt; &amp;G, Vector&lt; int &gt; &amp;ind, Vector&lt; T &gt; &amp;coeffs, T &amp;normX, const int L, const T eps, const T lambda=0)</div><div class="ttdoc">Auxiliary function of omp. </div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l00498">decomp.h:498</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a4ec917020dcfbde7c5bba128ecf19350"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a4ec917020dcfbde7c5bba128ecf19350">spams::ParamDictLearn::gamma2</a></div><div class="ttdeci">T gamma2</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00100">dicts.h:100</a></div></div>
<div class="ttc" id="namespacespams_html_aa437c45eb6500e07693bdec9305fd36e"><div class="ttname"><a href="namespacespams.html#aa437c45eb6500e07693bdec9305fd36e">spams::coreIST</a></div><div class="ttdeci">void coreIST(const AbstractMatrix&lt; T &gt; &amp;G, Vector&lt; T &gt; &amp;DtR, Vector&lt; T &gt; &amp;coeffs, const T thrs, const int itermax=500, const T tol=0.5)</div><div class="ttdoc">coreIST </div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l02052">decomp.h:2052</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aad7025532886772f710023fb22cd5476"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aad7025532886772f710023fb22cd5476">spams::ParamDictLearn::stochastic</a></div><div class="ttdeci">bool stochastic</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00115">dicts.h:115</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a5afb727394131f82e3290ce99b5fa271"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a5afb727394131f82e3290ce99b5fa271">spams::ParamDictLearn::DequalsW</a></div><div class="ttdeci">bool DequalsW</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00110">dicts.h:110</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a17240502f70436419bb12d13b2eaca4d"><div class="ttname"><a href="classspams_1_1Matrix.html#a17240502f70436419bb12d13b2eaca4d">spams::Matrix::conjugateGradient</a></div><div class="ttdeci">void conjugateGradient(const Vector&lt; T &gt; &amp;b, Vector&lt; T &gt; &amp;x, const T tol=1e-4, const int=4) const </div><div class="ttdoc">compute x, such that b = Ax, </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02482">linalg.h:2482</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a38355bdd8357a75965c159c36b91cee0"><div class="ttname"><a href="classspams_1_1Trainer.html#a38355bdd8357a75965c159c36b91cee0">spams::Trainer::_D</a></div><div class="ttdeci">Matrix&lt; T &gt; _D</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00178">dicts.h:178</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a240b3db2f487255b636f71726f24e108"><div class="ttname"><a href="classspams_1_1Matrix.html#a240b3db2f487255b636f71726f24e108">spams::Matrix::m</a></div><div class="ttdeci">int m() const </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00222">linalg.h:222</a></div></div>
<div class="ttc" id="classspams_1_1Timer_html"><div class="ttname"><a href="classspams_1_1Timer.html">spams::Timer</a></div><div class="ttdoc">Class Timer. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00138">utils.h:138</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_ac0fcddf0150534ca1b6f332aa9673d1a"><div class="ttname"><a href="classspams_1_1Trainer.html#ac0fcddf0150534ca1b6f332aa9673d1a">spams::Trainer::train</a></div><div class="ttdeci">void train(const Data&lt; T &gt; &amp;X, const ParamDictLearn&lt; T &gt; &amp;param)</div><div class="ttdoc">train or retrain using the matrix X </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00295">dicts.h:295</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_ae06ffb4f8cd6d00221697fc7b5d2f799"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#ae06ffb4f8cd6d00221697fc7b5d2f799">spams::ParamDictLearn::iter_updateD</a></div><div class="ttdeci">int iter_updateD</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00125">dicts.h:125</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a0c2023876ddd664f7a86c8e0c0d90d80"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a0c2023876ddd664f7a86c8e0c0d90d80">spams::ParamDictLearn::lambda3</a></div><div class="ttdeci">T lambda3</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00097">dicts.h:97</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a7626e4ab4348e6d688fa375e0c47803f"><div class="ttname"><a href="classspams_1_1Vector.html#a7626e4ab4348e6d688fa375e0c47803f">spams::Vector::n</a></div><div class="ttdeci">int n() const </div><div class="ttdoc">returns the size of the vector </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00591">linalg.h:591</a></div></div>
<div class="ttc" id="classspams_1_1Data_html"><div class="ttname"><a href="classspams_1_1Data.html">spams::Data</a></div><div class="ttdoc">Data class, abstract class, useful in the class image. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00130">linalg.h:130</a></div></div>
<div class="ttc" id="namespacespams_html_a6027bf4fab21cb18ed41910cd8c1b22d"><div class="ttname"><a href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22d">spams::constraint_type_D</a></div><div class="ttdeci">constraint_type_D</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00041">dicts.h:41</a></div></div>
<div class="ttc" id="utils_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00047">utils.h:47</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_acd98d17dc3e849239867785bf8c02e92"><div class="ttname"><a href="classspams_1_1Matrix.html#acd98d17dc3e849239867785bf8c02e92">spams::Matrix::refCol</a></div><div class="ttdeci">void refCol(int i, Vector&lt; T &gt; &amp;x) const </div><div class="ttdoc">Reference the column i into the vector x. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01144">linalg.h:1144</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html">spams::ParamDictLearn</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00044">dicts.h:44</a></div></div>
<div class="ttc" id="utils_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00048">utils.h:48</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a3fa90e3aac813bb98cb17e0a4e9bfd6d"><div class="ttname"><a href="classspams_1_1Vector.html#a3fa90e3aac813bb98cb17e0a4e9bfd6d">spams::Vector::setZeros</a></div><div class="ttdeci">void setZeros()</div><div class="ttdoc">Set all values to zero. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02871">linalg.h:2871</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a02981bc66aee73e231564e799f85dc4b"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a02981bc66aee73e231564e799f85dc4b">spams::ParamDictLearn::ThetaId</a></div><div class="ttdeci">bool ThetaId</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00109">dicts.h:109</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_ae7ab53078b68804ef29c699396304a9a"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#ae7ab53078b68804ef29c699396304a9a">spams::ParamDictLearn::mode</a></div><div class="ttdeci">constraint_type mode</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00088">dicts.h:88</a></div></div>
<div class="ttc" id="namespacespams_html_ab3efcaa595f15f3c4308049b7d83e309a158572eef9ce280536fbc2e295eeac0a"><div class="ttname"><a href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a158572eef9ce280536fbc2e295eeac0a">spams::PARAM1</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00042">dicts.h:42</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html"><div class="ttname"><a href="classspams_1_1Trainer.html">spams::Trainer</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00128">dicts.h:128</a></div></div>
<div class="ttc" id="classspams_1_1Data_html_ac7e5752efa8ffe96a571651c97e682d6"><div class="ttname"><a href="classspams_1_1Data.html#ac7e5752efa8ffe96a571651c97e682d6">spams::Data::getData</a></div><div class="ttdeci">virtual void getData(Vector&lt; T &gt; &amp;data, const int i) const  =0</div></div>
<div class="ttc" id="namespacespams_html_a6e0c56710b83e6ea3b2a757f8d202466"><div class="ttname"><a href="namespacespams.html#a6e0c56710b83e6ea3b2a757f8d202466">spams::abs</a></div><div class="ttdeci">T abs(const T x)</div><div class="ttdoc">template version of the fabs function </div></div>
<div class="ttc" id="classspams_1_1SpVector_html_a38540ea89ef9127b7cc0f5627815fa90"><div class="ttname"><a href="classspams_1_1SpVector.html#a38540ea89ef9127b7cc0f5627815fa90">spams::SpVector::refIndices</a></div><div class="ttdeci">void refIndices(Vector&lt; int &gt; &amp;indices) const </div><div class="ttdoc">create a reference on the vector r </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l04920">linalg.h:4920</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a86ea69e30691c39dac52ec3328b4f78f"><div class="ttname"><a href="classspams_1_1Trainer.html#a86ea69e30691c39dac52ec3328b4f78f">spams::Trainer::_itercount</a></div><div class="ttdeci">int _itercount</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00181">dicts.h:181</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aa351fafcc4d7dbc62f9605b3b51cb6ab"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aa351fafcc4d7dbc62f9605b3b51cb6ab">spams::ParamDictLearn::batch</a></div><div class="ttdeci">bool batch</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00117">dicts.h:117</a></div></div>
<div class="ttc" id="utils_8h_html_a8b5173357adb02a86c027316e0acdfa0"><div class="ttname"><a href="utils_8h.html#a8b5173357adb02a86c027316e0acdfa0">MAX_THREADS</a></div><div class="ttdeci">#define MAX_THREADS</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00042">utils.h:42</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a473e82c074925d3cf517a0d62ce03b43"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a473e82c074925d3cf517a0d62ce03b43">spams::ParamDictLearn::expand</a></div><div class="ttdeci">bool expand</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00104">dicts.h:104</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html"><div class="ttname"><a href="classspams_1_1Vector.html">spams::Vector</a></div><div class="ttdoc">Dense Vector class. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00065">linalg.h:65</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_af57893b5095264a1efe0ab064c539bf3"><div class="ttname"><a href="classspams_1_1Matrix.html#af57893b5095264a1efe0ab064c539bf3">spams::Matrix::copy</a></div><div class="ttdeci">void copy(const Matrix&lt; T &gt; &amp;mat)</div><div class="ttdoc">make a copy of the matrix mat in the current matrix </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01339">linalg.h:1339</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a41c883bc0f2cd1d4001385bd08304487"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a41c883bc0f2cd1d4001385bd08304487">spams::ParamDictLearn::lambda</a></div><div class="ttdeci">T lambda</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00087">dicts.h:87</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a91458c317453dced94ddfbb26338c538"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a91458c317453dced94ddfbb26338c538">spams::ParamDictLearn::updateW</a></div><div class="ttdeci">bool updateW</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00122">dicts.h:122</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_ae7a47651f6c2a53283e89dbe0787e387"><div class="ttname"><a href="classspams_1_1Vector.html#ae7a47651f6c2a53283e89dbe0787e387">spams::Vector::toSparse</a></div><div class="ttdeci">void toSparse(SpVector&lt; T &gt; &amp;vec) const </div><div class="ttdoc">make a sparse copy </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l04025">linalg.h:4025</a></div></div>
<div class="ttc" id="namespacespams_html_afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3"><div class="ttname"><a href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178af1b2e4b36f9ab7eed038b7b02d4227c3">spams::PENALTY</a></div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l00088">decomp.h:88</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a27ebb7c958e5c30a41876ed3425d867a"><div class="ttname"><a href="classspams_1_1Vector.html#a27ebb7c958e5c30a41876ed3425d867a">spams::Vector::set</a></div><div class="ttdeci">void set(const T val)</div><div class="ttdoc">set each value of the vector to val </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02997">linalg.h:2997</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a846f73329ac6894c176d8fa4ee9d47ef"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a846f73329ac6894c176d8fa4ee9d47ef">spams::ParamDictLearn::pattern</a></div><div class="ttdeci">bool pattern</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00114">dicts.h:114</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a5d9bff6098caee8ab8a0debc6fe862c3"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a5d9bff6098caee8ab8a0debc6fe862c3">spams::ParamDictLearn::ThetaDiag</a></div><div class="ttdeci">bool ThetaDiag</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00107">dicts.h:107</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a699acc9e95b317b4f95950ecd33150bb"><div class="ttname"><a href="classspams_1_1Vector.html#a699acc9e95b317b4f95950ecd33150bb">spams::Vector::thrsPos</a></div><div class="ttdeci">void thrsPos()</div><div class="ttdoc">performs soft-thresholding of the vector </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02973">linalg.h:2973</a></div></div>
<div class="ttc" id="decomp_8h_html"><div class="ttname"><a href="decomp_8h.html">decomp.h</a></div><div class="ttdoc">Contains sparse decomposition algorithms It requires the toolbox linalg. </div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aeca3ab01881e698c95d9dc68b585dfa7"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aeca3ab01881e698c95d9dc68b585dfa7">spams::ParamDictLearn::gamma1</a></div><div class="ttdeci">T gamma1</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00095">dicts.h:95</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a1660ce97b3ef358fba5c1ab19ebe0fba"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a1660ce97b3ef358fba5c1ab19ebe0fba">spams::ParamDictLearn::isConstant</a></div><div class="ttdeci">bool isConstant</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00105">dicts.h:105</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_ab958b0fde7ab004a414b3420bb4d7de9"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#ab958b0fde7ab004a414b3420bb4d7de9">spams::ParamDictLearn::scaleW</a></div><div class="ttdeci">bool scaleW</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00116">dicts.h:116</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a5b6764a578ce83e5c00a3e43b45d934a"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a5b6764a578ce83e5c00a3e43b45d934a">spams::ParamDictLearn::modeParam</a></div><div class="ttdeci">mode_compute modeParam</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00092">dicts.h:92</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_ad4d630bfd214f2f615a3ea5314b9b99e"><div class="ttname"><a href="classspams_1_1Trainer.html#ad4d630bfd214f2f615a3ea5314b9b99e">spams::Trainer::getB</a></div><div class="ttdeci">void getB(Matrix&lt; T &gt; &amp;B) const </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00155">dicts.h:155</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a2e6f0eeb0317dbfca23a5d293890d7ae"><div class="ttname"><a href="classspams_1_1Trainer.html#a2e6f0eeb0317dbfca23a5d293890d7ae">spams::Trainer::Trainer</a></div><div class="ttdeci">Trainer()</div><div class="ttdoc">Empty constructor. </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00187">dicts.h:187</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a47674518c5829a0b92c42d1b1fd8a384"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a47674518c5829a0b92c42d1b1fd8a384">spams::ParamDictLearn::whiten</a></div><div class="ttdeci">bool whiten</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00103">dicts.h:103</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a1df29954e4238f95d6ff5168c5e2dbf9"><div class="ttname"><a href="classspams_1_1Matrix.html#a1df29954e4238f95d6ff5168c5e2dbf9">spams::Matrix::mult</a></div><div class="ttdeci">void mult(const Vector&lt; T &gt; &amp;x, Vector&lt; T &gt; &amp;b, const T alpha=1.0, const T beta=0.0) const </div><div class="ttdoc">perform b = alpha*A*x+beta*b </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01783">linalg.h:1783</a></div></div>
<div class="ttc" id="classspams_1_1Timer_html_abfee07295de96dcb1751142d34eceab6"><div class="ttname"><a href="classspams_1_1Timer.html#abfee07295de96dcb1751142d34eceab6">spams::Timer::start</a></div><div class="ttdeci">void start()</div><div class="ttdoc">start the time </div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00146">utils.h:146</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a368747a8f19119275a4508f297c1875a"><div class="ttname"><a href="classspams_1_1Trainer.html#a368747a8f19119275a4508f297c1875a">spams::Trainer::_initialDict</a></div><div class="ttdeci">bool _initialDict</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00180">dicts.h:180</a></div></div>
<div class="ttc" id="namespacespams_html_a6027bf4fab21cb18ed41910cd8c1b22da0551a3470e9c5b498dfa269c82e8b2a8"><div class="ttname"><a href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da0551a3470e9c5b498dfa269c82e8b2a8">spams::L1L2MU</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00041">dicts.h:41</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_ae11862be7b7cad422d3dbfc708f05e20"><div class="ttname"><a href="classspams_1_1Matrix.html#ae11862be7b7cad422d3dbfc708f05e20">spams::Matrix::n</a></div><div class="ttdeci">int n() const </div><div class="ttdoc">Number of columns. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00224">linalg.h:224</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a29404de369c3cb0e95dff1d4768a02a5"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a29404de369c3cb0e95dff1d4768a02a5">spams::ParamDictLearn::weightClasses</a></div><div class="ttdeci">bool weightClasses</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00111">dicts.h:111</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a0cea90b654de7e163a184cbdbd12afd7"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a0cea90b654de7e163a184cbdbd12afd7">spams::ParamDictLearn::verbose</a></div><div class="ttdeci">bool verbose</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00118">dicts.h:118</a></div></div>
<div class="ttc" id="classspams_1_1SpVector_html"><div class="ttname"><a href="classspams_1_1SpVector.html">spams::SpVector</a></div><div class="ttdoc">Sparse Vector class. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00067">linalg.h:67</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_ae9b5c1be61a24d5fcfac043ea58b3c4d"><div class="ttname"><a href="classspams_1_1Trainer.html#ae9b5c1be61a24d5fcfac043ea58b3c4d">spams::Trainer::getD</a></div><div class="ttdeci">void getD(Matrix&lt; T &gt; &amp;D) const </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00156">dicts.h:156</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a658758da0725614d2c2bae5d5a2e08b0"><div class="ttname"><a href="classspams_1_1Matrix.html#a658758da0725614d2c2bae5d5a2e08b0">spams::Matrix::setZeros</a></div><div class="ttdeci">void setZeros()</div><div class="ttdoc">Set all the values to zero. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01240">linalg.h:1240</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_ab453b8b1a7e4aa9892b886d2854d6bf7"><div class="ttname"><a href="classspams_1_1Vector.html#ab453b8b1a7e4aa9892b886d2854d6bf7">spams::Vector::resize</a></div><div class="ttdeci">void resize(const int n)</div><div class="ttdoc">resize the vector </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02876">linalg.h:2876</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a39f55ac15d389f6f9d1a31cecea355a7"><div class="ttname"><a href="classspams_1_1Trainer.html#a39f55ac15d389f6f9d1a31cecea355a7">spams::Trainer::trainOffline</a></div><div class="ttdeci">void trainOffline(const Data&lt; T &gt; &amp;X, const ParamDictLearn&lt; T &gt; &amp;param)</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00736">dicts.h:736</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_aa568739ae8add04c588330e061e69a80"><div class="ttname"><a href="classspams_1_1Trainer.html#aa568739ae8add04c588330e061e69a80">spams::Trainer::getA</a></div><div class="ttdeci">void getA(Matrix&lt; T &gt; &amp;A) const </div><div class="ttdoc">Accessors. </div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00154">dicts.h:154</a></div></div>
<div class="ttc" id="namespacespams_html_ab3efcaa595f15f3c4308049b7d83e309a24e929906ec47db394a0236b303c4d31"><div class="ttname"><a href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a24e929906ec47db394a0236b303c4d31">spams::PARAM3</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00042">dicts.h:42</a></div></div>
<div class="ttc" id="classspams_1_1Timer_html_a0a4245820f6e390c5480878473c9407a"><div class="ttname"><a href="classspams_1_1Timer.html#a0a4245820f6e390c5480878473c9407a">spams::Timer::printElapsed</a></div><div class="ttdeci">void printElapsed()</div><div class="ttdoc">print the elapsed time </div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00182">utils.h:182</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a65235410dd18f72b674e6faed07b8d7a"><div class="ttname"><a href="classspams_1_1Trainer.html#a65235410dd18f72b674e6faed07b8d7a">spams::Trainer::_B</a></div><div class="ttdeci">Matrix&lt; T &gt; _B</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00177">dicts.h:177</a></div></div>
<div class="ttc" id="classspams_1_1SpVector_html_a2bfca57075fe416dbb99937aa1f78b5d"><div class="ttname"><a href="classspams_1_1SpVector.html#a2bfca57075fe416dbb99937aa1f78b5d">spams::SpVector::refVal</a></div><div class="ttdeci">void refVal(Vector&lt; T &gt; &amp;val) const </div><div class="ttdoc">creates a reference on the vector val </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l04926">linalg.h:4926</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a25c1e82f1ffa69efd8fed205754ff521"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a25c1e82f1ffa69efd8fed205754ff521">spams::ParamDictLearn::updateD</a></div><div class="ttdeci">bool updateD</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00121">dicts.h:121</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aa846d8d9e6e6a4945ee0a3d6b17f57ed"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aa846d8d9e6e6a4945ee0a3d6b17f57ed">spams::ParamDictLearn::extend</a></div><div class="ttdeci">bool extend</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00113">dicts.h:113</a></div></div>
<div class="ttc" id="classspams_1_1SpVector_html_a972fb20fab0fe4c086067811d26cefe3"><div class="ttname"><a href="classspams_1_1SpVector.html#a972fb20fab0fe4c086067811d26cefe3">spams::SpVector::resize</a></div><div class="ttdeci">void resize(const int nzmax)</div><div class="ttdoc">resizes the vector </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l04971">linalg.h:4971</a></div></div>
<div class="ttc" id="classspams_1_1Timer_html_a6daec457c61de062e6dab52f46e7fb30"><div class="ttname"><a href="classspams_1_1Timer.html#a6daec457c61de062e6dab52f46e7fb30">spams::Timer::getElapsed</a></div><div class="ttdeci">double getElapsed() const </div><div class="ttdoc">print the elapsed time </div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00193">utils.h:193</a></div></div>
<div class="ttc" id="namespacespams_html_a70671a263b259b8fcae010568dc63009"><div class="ttname"><a href="namespacespams.html#a70671a263b259b8fcae010568dc63009">spams::init_omp</a></div><div class="ttdeci">static int init_omp(const int numThreads)</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00264">misc.h:264</a></div></div>
<div class="ttc" id="namespacespams_html_ab3efcaa595f15f3c4308049b7d83e309a7e1c9255473878601d75beb52bf2ee0f"><div class="ttname"><a href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309a7e1c9255473878601d75beb52bf2ee0f">spams::AUTO</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00042">dicts.h:42</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_ac9d6af5817e8f5f56ab7f70a0f094832"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#ac9d6af5817e8f5f56ab7f70a0f094832">spams::ParamDictLearn::updateConstant</a></div><div class="ttdeci">bool updateConstant</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00106">dicts.h:106</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_ac1f2f5b3236f94ce2313dd2de5653d6f"><div class="ttname"><a href="classspams_1_1Trainer.html#ac1f2f5b3236f94ce2313dd2de5653d6f">spams::Trainer::_k</a></div><div class="ttdeci">int _k</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00179">dicts.h:179</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_aa8f835f2cd4c0fdb14dcd4a7321847b1"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#aa8f835f2cd4c0fdb14dcd4a7321847b1">spams::ParamDictLearn::lambda4</a></div><div class="ttdeci">T lambda4</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00098">dicts.h:98</a></div></div>
<div class="ttc" id="namespacespams_html_ab3efcaa595f15f3c4308049b7d83e309"><div class="ttname"><a href="namespacespams.html#ab3efcaa595f15f3c4308049b7d83e309">spams::mode_compute</a></div><div class="ttdeci">mode_compute</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00042">dicts.h:42</a></div></div>
<div class="ttc" id="namespacespams_html_a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b"><div class="ttname"><a href="namespacespams.html#a6027bf4fab21cb18ed41910cd8c1b22da45f1332d5e29f009f1d6ebefb1a07e8b">spams::L2</a></div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00041">dicts.h:41</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a832a8441ec0676f96767c2fb208ab650"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a832a8441ec0676f96767c2fb208ab650">spams::ParamDictLearn::logName</a></div><div class="ttdeci">char * logName</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00124">dicts.h:124</a></div></div>
<div class="ttc" id="namespacespams_html_a11a263a784992cfa353524e6a621ccaf"><div class="ttname"><a href="namespacespams.html#a11a263a784992cfa353524e6a621ccaf">spams::coreLARS2</a></div><div class="ttdeci">void coreLARS2(Vector&lt; T &gt; &amp;DtR, const AbstractMatrix&lt; T &gt; &amp;G, Matrix&lt; T &gt; &amp;Gs, Matrix&lt; T &gt; &amp;Ga, Matrix&lt; T &gt; &amp;invGs, Vector&lt; T &gt; &amp;u, Vector&lt; T &gt; &amp;coeffs, Vector&lt; int &gt; &amp;ind, Matrix&lt; T &gt; &amp;work, T &amp;normX, const constraint_type mode, const T constraint, const bool pos=false, T *pr_path=NULL, int length_path=-1)</div><div class="ttdoc">Auxiliary function for lasso. </div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l01556">decomp.h:1556</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_add56669d89cd16437ff3b3388f08a6b8"><div class="ttname"><a href="classspams_1_1Matrix.html#add56669d89cd16437ff3b3388f08a6b8">spams::Matrix::resize</a></div><div class="ttdeci">void resize(int m, int n)</div><div class="ttdoc">Resize the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01217">linalg.h:1217</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a1c2a39e500bcdba32db98d75a4bd62ba"><div class="ttname"><a href="classspams_1_1Vector.html#a1c2a39e500bcdba32db98d75a4bd62ba">spams::Vector::sub</a></div><div class="ttdeci">void sub(const Vector&lt; T &gt; &amp;x)</div><div class="ttdoc">A &lt;- A - x. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l03052">linalg.h:3052</a></div></div>
<div class="ttc" id="classspams_1_1Trainer_html_a3fa02dbb249a105df37a45c78605e076"><div class="ttname"><a href="classspams_1_1Trainer.html#a3fa02dbb249a105df37a45c78605e076">spams::Trainer::_NUM_THREADS</a></div><div class="ttdeci">int _NUM_THREADS</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00183">dicts.h:183</a></div></div>
<div class="ttc" id="namespacespams_html_afe8df4f71af4664583edb16ea9e97178ad0f58b113b123f31880b2605fa2219fa"><div class="ttname"><a href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178ad0f58b113b123f31880b2605fa2219fa">spams::L2ERROR2</a></div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l00088">decomp.h:88</a></div></div>
<div class="ttc" id="namespacespams_html_afe8df4f71af4664583edb16ea9e97178a25eec9a8e678cd0e6dc5a848c599f7b4"><div class="ttname"><a href="namespacespams.html#afe8df4f71af4664583edb16ea9e97178a25eec9a8e678cd0e6dc5a848c599f7b4">spams::SPARSITY</a></div><div class="ttdef"><b>Definition:</b> <a href="decomp_8h_source.html#l00088">decomp.h:88</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html"><div class="ttname"><a href="classspams_1_1Matrix.html">spams::Matrix</a></div><div class="ttdoc">Dense Matrix class. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00061">linalg.h:61</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a33dadcf0e24e66fffe033568aba6f552"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a33dadcf0e24e66fffe033568aba6f552">spams::ParamDictLearn::posD</a></div><div class="ttdeci">bool posD</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00091">dicts.h:91</a></div></div>
<div class="ttc" id="classspams_1_1Vector_html_a412980373e7341251055f7464659ea5d"><div class="ttname"><a href="classspams_1_1Vector.html#a412980373e7341251055f7464659ea5d">spams::Vector::randperm</a></div><div class="ttdeci">void randperm(int n)</div><div class="ttdoc">put a random permutation of size n (for integral vectors) </div></div>
<div class="ttc" id="classspams_1_1Data_html_aece44c8006c18b63ec4f10ab03b933de"><div class="ttname"><a href="classspams_1_1Data.html#aece44c8006c18b63ec4f10ab03b933de">spams::Data::n</a></div><div class="ttdeci">virtual int n() const  =0</div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a98d75501c22f06741ab695a43b9581d2"><div class="ttname"><a href="classspams_1_1Matrix.html#a98d75501c22f06741ab695a43b9581d2">spams::Matrix::add</a></div><div class="ttdeci">void add(const Matrix&lt; T &gt; &amp;mat, const T alpha=1.0)</div><div class="ttdoc">add alpha*mat to the current matrix </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l02062">linalg.h:2062</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a5b56b244cbdb30f93a4ea9386e16a7f2"><div class="ttname"><a href="classspams_1_1Matrix.html#a5b56b244cbdb30f93a4ea9386e16a7f2">spams::Matrix::scal</a></div><div class="ttdeci">void scal(const T a)</div><div class="ttdoc">scale the matrix by the a </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l01334">linalg.h:1334</a></div></div>
<div class="ttc" id="structspams_1_1ParamDictLearn_html_a2c72d6c74985cca5fdec1838e73d4df2"><div class="ttname"><a href="structspams_1_1ParamDictLearn.html#a2c72d6c74985cca5fdec1838e73d4df2">spams::ParamDictLearn::p</a></div><div class="ttdeci">T p</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00102">dicts.h:102</a></div></div>
<div class="ttc" id="classspams_1_1Matrix_html_a7155100cf149c9325423fbf9cf848909"><div class="ttname"><a href="classspams_1_1Matrix.html#a7155100cf149c9325423fbf9cf848909">spams::Matrix::rawX</a></div><div class="ttdeci">T * rawX() const </div><div class="ttdoc">reference a modifiable reference to the data, DANGEROUS </div><div class="ttdef"><b>Definition:</b> <a href="linalg_8h_source.html#l00254">linalg.h:254</a></div></div>
<div class="ttc" id="namespacespams_html_a4dfc0b17e355f0d776319be5cdb5eead"><div class="ttname"><a href="namespacespams.html#a4dfc0b17e355f0d776319be5cdb5eead">spams::writeLog</a></div><div class="ttdeci">void writeLog(const Matrix&lt; T &gt; &amp;D, const T time, int iter, char *name)</div><div class="ttdef"><b>Definition:</b> <a href="dicts_8h_source.html#l00717">dicts.h:717</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
